/* Início do Projeto: 23/9/2017 */

#include <stdio.h>
#include <stdlib.h>
#include <locale.h>

struct registro{ /*Estrutura para guardar os dados do usuário*/
    char conta[50], senha[50], usuario[50];
    }atual[1000];

void menu(){
    int i;
    do{

        printf("\t\t\t\tSISTEMA DE ACESSO AO LABORATÓRIO DE INFORMÁTICA");
        puts("\n");
        puts("\n");
        printf("                xxxxxx     xxx     xxx     xxxxxx     xxxxxxxxxxx     xxxxxxxx       xx          xx    \n"
               "                xx          xxx  xxx       xx             xxx         xx            xx xx      xx xx   \n"
               "                xxxxxx        xxxx         xxxxxx         xxx         xxxxxx        xx   xx   xx  xx   \n"
               "                    xx         xx              xx         xxx         xx            xx    xx xx   xx   \n"
               "                xxxxxx         xx          xxxxxx         xxx         xxxxxxxx      xx      xx    xx   \n"

                );
        puts("\n");
        puts("\n");
        printf("\t\t\t\t\t\tMENU PRINCIPAL");
        puts("\n");
        printf("\t\t\t\t\t1 - CADASTRO DE CONTA\n"
               "\t\t\t\t\t2 - REGISTRO DE ENTRADA/SAÍDA\n"
               "\t\t\t\t\t3 - ESTATÍSTICAS DE ACESSO\n"
               "\t\t\t\t\t0 - FINALIZAR");
        puts("\n");
        printf("\t\t\t\t\tOPÇÃO : ");
        scanf("%i", &i);
        switch(i){
            case 1:system("cls");cadastro();break;

            case 0:exit(0); //Finaliza o programa
            default:system("cls");
                    printf("\n\n\t\t\t\tDIGITE UMA OPÇÃO VÁLIDA\n");
                    puts("\n");
        }
    }while(i!=0);
}
void cadastro(int i) {
    char c;
    int v = 0, j;
    struct registro atual[1000];
    inicio: system("cls");
    do{
        printf("\t\tSISTEMA DE ACESSO AO LABORATÓRIO DE INFORMÁTICA");
        puts("\n");
        printf("\t\t\t\tCADASTRO DE CONTA");
        puts("\n");
        printf("\t\t\t1 - INCLUSÃO\n"
           "\t\t\t2 - ALTERAÇÃO\n"
           "\t\t\t3 - CONSULTA\n"
           "\t\t\t4 - EXCLUSÃO\n"
           "\t\t\t0 - RETORNAR\n");
        puts("\n");
        printf("\t\t\t\tOPÇÃO : ");
        scanf("%i", &i);
        switch(i) {
            case 1:inclui:
                do{
                    setbuf(stdin, NULL); //Limpa o buffer
                    system("cls");
                    printf("\t\tSISTEMA DE ACESSO AO LABORATÓRIO DE INFORMÁTICA");
                    puts("\n");
                    printf("\t\t\t\tINCLUSÃO DE CONTA");
                    puts("\n");
                    printf("\t\t\tConta : ");
                    gets(atual[v].conta);
                    printf("%s","\t\t\tSenha: ");
                do{
                    c=getch();
                    if(isprint(c)) {    //Analisa se o valor da variável c é imprimivel
                        atual[v].senha[i]=c;
                        i++;
                        printf("*");
                    }else
                        if(c==8) {   //8 é o caractere BackSpace na tabela ASCII
                            atual[v].senha[i]='\0';
                            i--;
                            printf("\b \b");    //Apaga o caractere digitado
                    }
                }while(c!=13);             //13 é o valor de ENTER na tabela ASCII
                    atual[v].senha[i]='\0';
                    setbuf(stdin, NULL);
                    printf("\n\t\t\tUsuário: ");
                    gets(atual[v].usuario);
                    puts("\n");
                    printf("\t\t\tCONFIRMA INCLUSÃO (S/N) ?");
                    scanf("%c", &c);
                    if ((c == 'S')||(c =='s')) {
                        setbuf(stdin, NULL);
                        puts("\n");
                        printf("\t\t\tCadastro efetuado.\n");
                        puts("\n");
                        printf("\t\t\tPressione enter para continuar");
                        getch(); //Pausa
                        system("cls");
                    }else{
                        if((c == 'N')||(c == 'n')){
                           system("cls");
                           atual[v].conta[v] = "";       //Zera posição
                           atual[v].senha[v] = "";
                           atual[v].usuario[v] = "";
                           goto inicio;
                        }
                    }
                        v++;
                    }while((c == 'N')||(c == 'n'));



                    break;

             case 3:system("cls");
                    printf("\t\t\t\t\tCONTAS");
                    for(j=0; j<v; j++){
                    puts("\n");
                    printf("\t\t\tConta: %s\n", atual[j].conta);
                    printf("\t\t\tUsuário: %s", atual[j].usuario);
                    puts("\n");
                    }
                    getch();
                    goto inicio;



                    break;




            default:system("cls");
                printf("\n\n\t\t\t\tDIGITE UMA OPÇÃO VÁLIDA\n");
                puts("\n");

            }



    }while(i!=0);
}

int main(void) {
    setlocale(LC_ALL,"");
    menu();
    return 0;
}
